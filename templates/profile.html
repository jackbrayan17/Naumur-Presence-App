{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Profile" %} | Naumur Presence App{% endblock %}

{% block content %}
  <section class="card">
    <div class="card-header">
      <div>
        <h1>{% trans "Profile" %}</h1>
        <p class="muted">{% trans "Update your profile picture." %}</p>
      </div>
    </div>

    <div class="profile-grid">
      <div class="profile-summary">
        {% if user.profile_image %}
          <img class="profile-avatar" src="{{ user.profile_image.url }}" alt="{{ user.get_full_name|default:user.username }}" />
        {% else %}
          <div class="profile-avatar avatar-fallback" style="background: {{ user.avatar_color }};">
            {{ user.initials }}
          </div>
        {% endif %}
        <div>
          <div class="profile-name">{{ user.get_full_name|default:user.username }}</div>
          <div class="muted">{% trans "Start date" %}: {{ user.start_date }}</div>
          <div class="muted">{{ user.department.name|default:"-" }}</div>
        </div>
      </div>

      <form method="post" enctype="multipart/form-data" class="form profile-form">
        {% csrf_token %}
        <div class="field">
          <label for="{{ form.profile_image.id_for_label }}">{% trans "Profile picture" %}</label>
          {{ form.profile_image }}
          {{ form.profile_image.errors }}
        </div>
        <button class="btn btn-primary" type="submit">{% trans "Save" %}</button>
      </form>
    </div>

    <div class="timeline">
      <h2>{% trans "Activity timeline" %}</h2>
      <div class="timeline-list">
        {% for activity in activities %}
          <div class="timeline-item">
            <div class="timeline-time">{{ activity.created_at|date:"Y-m-d H:i" }}</div>
            <div>
              <div class="timeline-message">{{ activity.message }}</div>
              <div class="muted">
                {% trans "By" %} {{ activity.actor.get_full_name|default:activity.actor.username|default:"System" }}
              </div>
            </div>
          </div>
        {% empty %}
          <div class="row-muted">{% trans "No activity yet." %}</div>
        {% endfor %}
      </div>
    </div>
  </section>
{% endblock %}
